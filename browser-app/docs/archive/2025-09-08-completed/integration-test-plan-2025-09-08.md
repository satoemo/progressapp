# 統合テスト実施計画 - 2025-09-08

## 概要
Phase 2完了後の全機能統合テストを実施し、システムの安定性とパフォーマンスを確認する。

## テスト目的
1. 新サービス層の動作確認
2. パフォーマンス改善の効果測定
3. バグ修正の確認
4. システム全体の安定性確認

## テスト環境
- **ブラウザ**: Chrome/Edge最新版
- **テストファイル**: test-api-mock.html?eventStore=mock
- **データ**: 50件のダミーデータ使用
- **実行スクリプト**: test-integrated-2025-09-08.js

## テスト項目と予定時間（合計3時間）

### 1. テスト環境準備（30分）
- [ ] テスト用ビルド実行（webpack.config.test.cjs使用）
- [ ] test-api-mock.htmlの起動確認
- [ ] ダミーデータ生成（50件）
- [ ] LocalStorageクリア・初期化

### 2. 機能テスト（1時間）

#### 2.1 基本CRUD操作（20分）
- [ ] カット作成（新規カット追加）
- [ ] カット読込（全件取得・個別取得）
- [ ] カット更新（基本情報・進捗・コスト・兼用）
- [ ] カット削除（削除確認ダイアログ含む）

#### 2.2 メモ機能（15分）
- [ ] セルメモの作成
- [ ] セルメモの読込
- [ ] セルメモの更新
- [ ] セルメモの削除

#### 2.3 UI操作テスト（25分）
- [ ] 進捗フィールド入力
  - [ ] 日付入力
  - [ ] 「不要」選択
  - [ ] 「リテイク」選択
  - [ ] 空白クリア
- [ ] ステータス自動計算確認
- [ ] オートフィル機能（列・行）
- [ ] 兼用フィールドの同期
- [ ] タブ切り替え動作

### 3. パフォーマンステスト（30分）

#### 3.1 応答速度測定（15分）
- [ ] getAllCuts実行時間（目標: <100ms）
- [ ] 個別カット取得時間
- [ ] 更新操作の応答時間
- [ ] UI操作の反応速度

#### 3.2 リソース使用量（15分）
- [ ] データ取得回数（目標: <10回/操作）
- [ ] LocalStorage使用量
- [ ] メモリ使用量
- [ ] デバッグログサイズ

### 4. 安定性テスト（30分）

#### 4.1 データ永続性（15分）
- [ ] リロード後のデータ表示
- [ ] LocalStorageデータの確認
- [ ] ReadModelStoreの同期確認
- [ ] バックアップ機能の動作

#### 4.2 状態管理（15分）
- [ ] タブ切り替え時の状態保持
- [ ] 複数ウィンドウでの同期
- [ ] セッション間のデータ共有
- [ ] キャッシュの整合性

### 5. エラーハンドリングテスト（30分）

#### 5.1 不正入力処理（15分）
- [ ] 不正なカット番号
- [ ] 空のデータ送信
- [ ] 文字数制限超過
- [ ] 特殊文字の処理

#### 5.2 システムエラー処理（15分）
- [ ] 存在しないIDでの操作
- [ ] LocalStorage満杯時の処理
- [ ] 同時更新の競合
- [ ] ネットワークエラー（モック環境）

## 合格基準

### 必須要件
- すべての基本CRUD操作が正常に動作
- データがリロード後も保持される
- パフォーマンス目標を達成（getAllCuts <100ms）
- 致命的なエラーが発生しない

### 推奨要件
- UI操作がスムーズ（体感的な遅延なし）
- エラー時に適切なメッセージ表示
- メモリリークが発生しない
- デバッグログが適切なサイズ

## テスト実行手順

1. **ビルド実行**
   ```bash
   npm run build:test
   ```

2. **テスト環境起動**
   ```bash
   ./run-test.sh
   ```
   または手動で`test-api-mock.html`を開く

3. **テスト実行**
   - F12で開発者コンソールを開く
   - コンソールで`runCompleteTest()`を実行
   - または「統合テスト実行」ボタンをクリック

4. **結果確認**
   - コンソールに表示される結果を確認
   - `window.completeTestResults`で詳細確認
   - 失敗項目があれば原因を調査

## 問題発生時の対応

### テストが失敗した場合
1. エラーメッセージを記録
2. 再現手順を確認
3. `/docs/bug-analysis-2025-09-08.md`に記載
4. 修正後、該当テストのみ再実行

### パフォーマンス問題の場合
1. Chrome DevToolsのPerformanceタブで詳細分析
2. ボトルネックを特定
3. 最適化案を検討
4. 段階的に改善実施

## 完了条件
- 全テスト項目の実行完了
- 合格基準の達成
- 問題点の文書化
- 次フェーズへの準備完了

## 次のステップ
テスト完了後：
1. CommandBus/QueryBusの段階的削除
2. Phase 3計画の策定
3. 本番環境への展開準備